{
  "version": 3,
  "sources": ["i18n.js"],
  "sourcesContent": ["/**\n * Beatify Internationalization (i18n) Module\n * Provides translation functionality for all UI text\n */\n// Use window.BeatifyI18n to ensure global availability after minification (IIFE wrapping)\nwindow.BeatifyI18n = (function() {\n    'use strict';\n\n    // Current language code\n    var currentLanguage = 'en';\n\n    // Loaded translations\n    var translations = {};\n\n    // Fallback translations (English)\n    var fallbackTranslations = {};\n\n    // Loading state\n    var isLoaded = false;\n    var loadPromise = null;\n\n    /**\n     * Load translations for a specific language\n     * @param {string} langCode - Language code ('en', 'de', 'es', or 'fr')\n     * @returns {Promise<Object>} - Loaded translations\n     */\n    async function fetchTranslations(langCode) {\n        try {\n            var response = await fetch('/beatify/static/i18n/' + langCode + '.json');\n            if (!response.ok) {\n                console.warn('[i18n] Failed to load ' + langCode + '.json:', response.status);\n                return {};\n            }\n            return await response.json();\n        } catch (err) {\n            console.warn('[i18n] Error loading ' + langCode + '.json:', err);\n            return {};\n        }\n    }\n\n    /**\n     * Load translations for current language\n     * @returns {Promise<void>}\n     */\n    async function loadTranslations() {\n        // Load English as fallback first\n        if (Object.keys(fallbackTranslations).length === 0) {\n            fallbackTranslations = await fetchTranslations('en');\n        }\n\n        // Load current language\n        if (currentLanguage === 'en') {\n            translations = fallbackTranslations;\n        } else {\n            translations = await fetchTranslations(currentLanguage);\n        }\n\n        isLoaded = true;\n    }\n\n    /**\n     * Get nested value from object using dot notation\n     * @param {Object} obj - Object to traverse\n     * @param {string} key - Dot-separated key path\n     * @returns {string|undefined} - Found value or undefined\n     */\n    function getNestedValue(obj, key) {\n        if (!obj || !key) return undefined;\n\n        var parts = key.split('.');\n        var current = obj;\n\n        for (var i = 0; i < parts.length; i++) {\n            if (current === undefined || current === null) {\n                return undefined;\n            }\n            current = current[parts[i]];\n        }\n\n        return current;\n    }\n\n    /**\n     * Translate a key to the current language\n     * @param {string} key - Translation key (e.g., 'lobby.title')\n     * @param {Object} [params] - Optional parameters for interpolation\n     * @returns {string} - Translated string\n     */\n    function t(key, params) {\n        // Try current language first\n        var value = getNestedValue(translations, key);\n\n        // Fall back to English if not found\n        if (value === undefined && currentLanguage !== 'en') {\n            value = getNestedValue(fallbackTranslations, key);\n            if (value !== undefined) {\n                console.warn('[i18n] Missing translation for \"' + key + '\" in ' + currentLanguage + ', using English');\n            }\n        }\n\n        // Return key itself as last resort\n        if (value === undefined) {\n            console.warn('[i18n] Missing translation key: \"' + key + '\"');\n            return key;\n        }\n\n        // Interpolate parameters if provided\n        if (params && typeof value === 'string') {\n            Object.keys(params).forEach(function(param) {\n                value = value.replace(new RegExp('\\\\{' + param + '\\\\}', 'g'), params[param]);\n            });\n        }\n\n        return value;\n    }\n\n    /**\n     * Get error message for error code\n     * @param {string} code - Error code from server\n     * @returns {string} - Translated error message\n     */\n    function getErrorMessage(code) {\n        return t('errors.' + code) || t('errors.UNKNOWN');\n    }\n\n    /**\n     * Supported languages (Story 16.3 - added Spanish)\n     */\n    var SUPPORTED_LANGUAGES = ['en', 'de', 'es', 'fr'];\n\n    /**\n     * Set the current language\n     * @param {string} langCode - Language code ('en', 'de', 'es', or 'fr')\n     * @returns {Promise<void>}\n     */\n    async function setLanguage(langCode) {\n        // Validate language code (Story 16.3 - added Spanish support)\n        if (SUPPORTED_LANGUAGES.indexOf(langCode) === -1) {\n            console.warn('[i18n] Invalid language code: ' + langCode + ', defaulting to en');\n            langCode = 'en';\n        }\n\n        if (langCode === currentLanguage && isLoaded) {\n            return;\n        }\n\n        currentLanguage = langCode;\n        await loadTranslations();\n    }\n\n    /**\n     * Get current language code\n     * @returns {string} - Current language code\n     */\n    function getLanguage() {\n        return currentLanguage;\n    }\n\n    /**\n     * Initialize page translations by replacing data-i18n elements\n     * Call this after translations are loaded and DOM is ready\n     */\n    function initPageTranslations() {\n        var elements = document.querySelectorAll('[data-i18n]');\n        elements.forEach(function(el) {\n            var key = el.getAttribute('data-i18n');\n            if (key) {\n                var translated = t(key);\n                // Only update if we got a real translation (not the key back)\n                if (translated !== key) {\n                    el.textContent = translated;\n                }\n            }\n        });\n\n        // Handle placeholders\n        var placeholderElements = document.querySelectorAll('[data-i18n-placeholder]');\n        placeholderElements.forEach(function(el) {\n            var key = el.getAttribute('data-i18n-placeholder');\n            if (key) {\n                var translated = t(key);\n                if (translated !== key) {\n                    el.placeholder = translated;\n                }\n            }\n        });\n\n        // Handle title attributes\n        var titleElements = document.querySelectorAll('[data-i18n-title]');\n        titleElements.forEach(function(el) {\n            var key = el.getAttribute('data-i18n-title');\n            if (key) {\n                var translated = t(key);\n                if (translated !== key) {\n                    el.title = translated;\n                }\n            }\n        });\n    }\n\n    /**\n     * Detect browser language and return 'de', 'es', or 'en' (Story 16.3)\n     * Supports Spanish variants: es, es-ES, es-MX, es-AR, etc.\n     * @returns {string} - Detected language code\n     */\n    function detectBrowserLanguage() {\n        var browserLang = navigator.language || navigator.userLanguage || 'en';\n        var langLower = browserLang.toLowerCase();\n        // Check for German (de, de-DE, de-AT, etc.)\n        if (langLower.startsWith('de')) {\n            return 'de';\n        }\n        // Check for Spanish (es, es-ES, es-MX, es-AR, es-CO, etc.)\n        if (langLower.startsWith('es')) {\n            return 'es';\n        }\n        // Check for French (fr, fr-FR, fr-CA, fr-BE, fr-CH, etc.)\n        if (langLower.startsWith('fr')) {\n            return 'fr';\n        }\n        // Default to English\n        return 'en';\n    }\n\n    /**\n     * Initialize i18n with optional language\n     * @param {string} [langCode] - Language code, or auto-detect if not provided\n     * @returns {Promise<void>}\n     */\n    async function init(langCode) {\n        if (loadPromise) {\n            return loadPromise;\n        }\n\n        var lang = langCode || detectBrowserLanguage();\n        loadPromise = setLanguage(lang);\n        await loadPromise;\n    }\n\n    /**\n     * Check if translations are loaded\n     * @returns {boolean}\n     */\n    function isReady() {\n        return isLoaded;\n    }\n\n    // Public API\n    return {\n        t: t,\n        getErrorMessage: getErrorMessage,\n        setLanguage: setLanguage,\n        getLanguage: getLanguage,\n        initPageTranslations: initPageTranslations,\n        detectBrowserLanguage: detectBrowserLanguage,\n        init: init,\n        isReady: isReady\n    };\n})();\n\n// Shorthand for translation function (use window to ensure global availability after minification)\nwindow.t = window.BeatifyI18n.t;\n"],
  "mappings": "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",
  "names": ["currentLanguage", "translations", "fallbackTranslations", "isLoaded", "loadPromise", "fetchTranslations", "langCode", "__async", "response", "err", "loadTranslations", "getNestedValue", "obj", "key", "parts", "current", "i", "t", "params", "value", "param", "getErrorMessage", "code", "SUPPORTED_LANGUAGES", "setLanguage", "getLanguage", "initPageTranslations", "elements", "el", "translated", "placeholderElements", "titleElements", "detectBrowserLanguage", "browserLang", "langLower", "init", "lang", "isReady"]
}
