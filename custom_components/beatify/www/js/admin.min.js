(()=>{var Z=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports);var f=(e,t,n)=>new Promise((a,s)=>{var c=i=>{try{o(n.next(i))}catch(l){s(l)}},r=i=>{try{o(n.throw(i))}catch(l){s(l)}},o=i=>i.done?a(i.value):Promise.resolve(i.value).then(c,r);o((n=n.apply(e,t)).next())});var Ae=Z(Y=>{let m=[],H=[],T="",y=null,j="",x="setup",p=null,I=null,v="en",S=45,b="normal",E="spotify",ee=!1,w=!0,k=[],A=null;const Q="beatify_last_player",F="beatify_game_settings",G=["media-players","playlists","game-settings","admin-actions"],te={music_assistant:{icon:"\u{1F3B5}",label:"Music Assistant",recommended:!0},sonos:{icon:"\u{1F50A}",label:"Sonos"},alexa_media:{icon:"\u{1F4E2}",label:"Alexa"},alexa:{icon:"\u{1F4E2}",label:"Alexa"}},d=window.BeatifyUtils||{};document.addEventListener("DOMContentLoaded",()=>f(Y,null,function*(){var t,n,a,s,c,r;(yield d.waitForI18n())?(yield BeatifyI18n.init(),BeatifyI18n.initPageTranslations(),v=BeatifyI18n.getLanguage()):console.error("[Beatify] BeatifyI18n module failed to load - UI will use fallback text"),document.querySelectorAll(".chip[data-lang]").forEach(o=>{o.classList.toggle("chip--active",o.dataset.lang===v)}),(t=document.getElementById("start-game"))==null||t.addEventListener("click",ve),(n=document.getElementById("print-qr"))==null||n.addEventListener("click",Ie),(a=document.getElementById("rejoin-game"))==null||a.addEventListener("click",Le),(s=document.getElementById("end-game"))==null||s.addEventListener("click",P),(c=document.getElementById("end-game-lobby"))==null||c.addEventListener("click",P),(r=document.getElementById("end-game-existing"))==null||r.addEventListener("click",P),Se(),be(),ae(),ie(),yield se(),yield ne()}));function ne(){return f(this,null,function*(){try{const e=yield fetch("/beatify/api/status");if(!e.ok)throw new Error(`HTTP ${e.status}`);const t=yield e.json();T=t.playlist_docs_url||"",j=t.media_player_docs_url||"",ee=t.has_music_assistant===!0;const n=document.getElementById("app-version");n&&t.version&&(n.textContent="v"+t.version),ce(t.media_players),fe(t.playlists,t.playlist_dir),C(),t.active_game?ye(t.active_game):V()}catch(e){console.error("Failed to load status:",e);const t=document.getElementById("media-players-list");t&&(t.innerHTML='<span class="status-error">Failed to load status</span>')}})}function ae(){var e,t;(e=document.getElementById("media-players-toggle"))==null||e.addEventListener("click",function(){const n=document.getElementById("media-players");n&&(n.classList.toggle("collapsed"),this.setAttribute("aria-expanded",!n.classList.contains("collapsed")))}),(t=document.getElementById("game-settings-toggle"))==null||t.addEventListener("click",function(){const n=document.getElementById("game-settings");n&&(n.classList.toggle("collapsed"),this.setAttribute("aria-expanded",!n.classList.contains("collapsed")))}),document.querySelectorAll(".lobby-container--compact .section-header-collapsible").forEach(function(n){n.addEventListener("click",function(){const a=n.closest(".section-collapsible");a&&(a.classList.toggle("collapsed"),n.setAttribute("aria-expanded",!a.classList.contains("collapsed")))})})}function ie(){var e;document.querySelectorAll(".chip[data-lang]").forEach(t=>{t.addEventListener("click",function(){return f(this,null,function*(){const n=this.dataset.lang;document.querySelectorAll(".chip[data-lang]").forEach(a=>a.classList.remove("chip--active")),this.classList.add("chip--active"),v=n,window.BeatifyI18n&&(yield BeatifyI18n.setLanguage(n),BeatifyI18n.initPageTranslations()),h(),L()})})}),document.querySelectorAll(".chip[data-duration]").forEach(t=>{t.addEventListener("click",function(){const n=parseInt(this.dataset.duration,10);document.querySelectorAll(".chip[data-duration]").forEach(a=>a.classList.remove("chip--active")),this.classList.add("chip--active"),S=n,h(),L()})}),document.querySelectorAll(".chip[data-difficulty]").forEach(t=>{t.addEventListener("click",function(){const n=this.dataset.difficulty;document.querySelectorAll(".chip[data-difficulty]").forEach(a=>a.classList.remove("chip--active")),this.classList.add("chip--active"),b=n,h(),L()})}),(e=document.getElementById("artist-challenge-toggle"))==null||e.addEventListener("change",function(){w=this.checked,h(),L()}),document.querySelectorAll(".chip[data-provider]").forEach(t=>{t.addEventListener("click",function(){if(this.disabled||this.classList.contains("provider-btn--disabled"))return;const n=this.dataset.provider;document.querySelectorAll(".chip[data-provider]").forEach(a=>a.classList.remove("chip--active")),this.classList.add("chip--active"),E=n,h(),L()})})}function se(){return f(this,null,function*(){try{const e=localStorage.getItem(F);if(e){const t=JSON.parse(e);if(t.language&&(v=t.language,document.querySelectorAll(".chip[data-lang]").forEach(n=>{n.classList.toggle("chip--active",n.dataset.lang===t.language)}),window.BeatifyI18n&&(yield BeatifyI18n.setLanguage(t.language))),t.duration&&(S=t.duration,document.querySelectorAll(".chip[data-duration]").forEach(n=>{n.classList.toggle("chip--active",parseInt(n.dataset.duration,10)===t.duration)})),t.difficulty&&(b=t.difficulty,document.querySelectorAll(".chip[data-difficulty]").forEach(n=>{n.classList.toggle("chip--active",n.dataset.difficulty===t.difficulty)})),typeof t.artistChallenge=="boolean"){w=t.artistChallenge;const n=document.getElementById("artist-challenge-toggle");n&&(n.checked=t.artistChallenge)}t.provider&&(E=t.provider,document.querySelectorAll(".chip[data-provider]").forEach(n=>{n.classList.toggle("chip--active",n.dataset.provider===t.provider)}))}}catch(e){console.warn("Failed to load saved settings:",e)}h()})}function L(){try{const e={language:v,duration:S,difficulty:b,artistChallenge:w,provider:E};localStorage.setItem(F,JSON.stringify(e))}catch(e){console.warn("Failed to save settings:",e)}}function h(){const e=document.getElementById("game-settings-summary");if(!e)return;const t={easy:"Easy",normal:"Normal",hard:"Hard"},n={en:"EN",de:"DE",es:"ES"},a=w?" \u2022 \u{1F3A4}":"";e.textContent=`${t[b]||"Normal"} \u2022 ${S}s \u2022 ${n[v]||"EN"}${a}`}function oe(e){const t=document.getElementById("media-player-summary");t&&(t.textContent=e||"Select...")}function le(e){const t={};return e.forEach(n=>{const a=n.platform||"unknown";t[a]||(t[a]=[]),t[a].push(n)}),t}function ce(e){const t=document.getElementById("media-players-list");t==null||t.removeAttribute("data-i18n");const n=e?e.length:0;y=null;const a=(e||[]).filter(i=>i.state!=="unavailable"),s=document.getElementById("media-player-validation-msg");if(n===0){t.innerHTML=`
            <div class="no-players-message">
                <h3>\u{1F3B5} No Compatible Players Found</h3>
                <p>Beatify works with Music Assistant, Sonos, and Alexa players.</p>
                <p><strong>Recommended:</strong> Install Music Assistant for the best experience with any speaker.</p>
                <div class="button-group">
                    <a href="https://music-assistant.io/getting-started/"
                       target="_blank" class="btn btn-secondary">
                        \u{1F4D6} Music Assistant Setup Guide
                    </a>
                    <button onclick="loadStatus()" class="btn btn-primary">
                        \u{1F504} Refresh
                    </button>
                </div>
            </div>
        `,s&&s.classList.add("hidden");const i=document.getElementById("start-game");i&&(i.disabled=!0);return}if(a.length===0){const i=j?`<a href="${d.escapeHtml(j)}" target="_blank" rel="noopener">Troubleshooting</a>`:"";t.innerHTML=`
            <div class="empty-state">
                <p class="status-error">All media players are unavailable. Check your devices are powered on.</p>
                ${i?`<p style="margin-top: 12px;">${i}</p>`:""}
            </div>
        `,s&&s.classList.add("hidden");return}const c=le(a);let r="";for(const[i,l]of Object.entries(c)){const u=te[i]||{icon:"\u{1F508}",label:i},g=u.recommended?' <span class="badge-recommended">Recommended</span>':"";r+=`
            <div class="player-group">
                <h4 class="player-group-header">${u.icon} ${u.label}${g}</h4>
                ${l.map(q=>de(q)).join("")}
            </div>
        `}t.innerHTML=r,re();const o=localStorage.getItem(Q);if(o){const i=t.querySelector(`[data-entity-id="${o}"]`);if(i){i.checked=!0,N(i,!0);const l=document.getElementById("media-players");if(l){l.classList.add("collapsed");const u=document.getElementById("media-players-toggle");u&&u.setAttribute("aria-expanded","false")}}}}function de(e){const t=e.caveat?`<div class="player-caveat">${d.escapeHtml(e.caveat)}</div>`:"";return`
        <div class="media-player-item list-item is-selectable"
             data-entity-id="${d.escapeHtml(e.entity_id)}"
             data-platform="${d.escapeHtml(e.platform)}"
             data-supports-spotify="${e.supports_spotify}"
             data-supports-apple-music="${e.supports_apple_music}">
            <label class="radio-label">
                <input type="radio"
                       class="media-player-radio"
                       name="media-player"
                       data-entity-id="${d.escapeHtml(e.entity_id)}"
                       data-state="${d.escapeHtml(e.state)}"
                       data-platform="${d.escapeHtml(e.platform)}"
                       data-supports-spotify="${e.supports_spotify}"
                       data-supports-apple-music="${e.supports_apple_music}">
                <span class="player-name">${d.escapeHtml(e.friendly_name)}</span>
            </label>
            <span class="meta">
                <span class="state-dot state-${d.escapeHtml(e.state)}"></span>
                ${d.escapeHtml(e.state)}
            </span>
            ${t}
        </div>
    `}function re(){const e=document.getElementById("media-players-list");e&&(e.querySelectorAll(".media-player-radio").forEach(t=>{t.addEventListener("change",function(){N(this)})}),e.querySelectorAll(".media-player-item").forEach(t=>{t.addEventListener("click",function(n){if(n.target.classList.contains("media-player-radio")||n.target.closest(".radio-label"))return;const a=t.querySelector(".media-player-radio");a&&!a.checked&&(a.checked=!0,N(a))})}))}function N(e,t=!1){var l,u;const n=e.dataset.entityId,a=e.dataset.state,s=e.dataset.platform,c=e.dataset.supportsSpotify==="true",r=e.dataset.supportsAppleMusic==="true";y={entityId:n,state:a,platform:s,supportsSpotify:c,supportsAppleMusic:r},document.querySelectorAll(".media-player-item").forEach(g=>{g.classList.remove("is-selected")});const o=e.closest(".media-player-item");o.classList.add("is-selected");const i=((u=(l=o.querySelector(".player-name"))==null?void 0:l.textContent)==null?void 0:u.trim())||n;if(oe(i),ue(y),me(y),!t)try{localStorage.setItem(Q,n)}catch(g){console.warn("Failed to save last player:",g)}C()}function ue(e){const t=document.querySelector('.chip[data-provider="spotify"]'),n=document.querySelector('.chip[data-provider="apple_music"]');t&&(t.disabled=!e.supportsSpotify,t.classList.toggle("chip--disabled",!e.supportsSpotify)),n&&(n.disabled=!e.supportsAppleMusic,n.classList.toggle("chip--disabled",!e.supportsAppleMusic)),E==="apple_music"&&!e.supportsAppleMusic&&(document.querySelectorAll(".chip[data-provider]").forEach(s=>s.classList.remove("chip--active")),t&&t.classList.add("chip--active"),E="spotify");const a=document.getElementById("provider-hint");a&&(e.supportsAppleMusic?a.classList.add("hidden"):(a.textContent="Apple Music requires Music Assistant speaker",a.classList.remove("hidden")))}function me(e){const t=document.getElementById("provider-warning");if(!t)return;const a={music_assistant:"Premium account must be configured in Music Assistant",sonos:"Spotify must be linked in Sonos app",alexa_media:"Service must be linked in Alexa app",alexa:"Service must be linked in Alexa app"}[e.platform];a?(t.innerHTML=`<p>\u26A0\uFE0F ${d.escapeHtml(a)}</p>`,t.classList.remove("hidden")):t.classList.add("hidden")}function fe(e,t){var s,c,r;const n=document.getElementById("playlists-list");n==null||n.removeAttribute("data-i18n"),m=[],H=e||[];const a=H.some(o=>o.is_valid);if(!e||e.length===0){const o=T?`<a href="${d.escapeHtml(T)}" target="_blank" rel="noopener">How to create playlists</a>`:"";n.innerHTML=`
            <div class="empty-state">
                <p class="status-error">No playlists found. Add playlist JSON files to:</p>
                <p style="font-size: 14px;"><code>${d.escapeHtml(t)}</code></p>
                ${o?`<p style="margin-top: 12px;">${o}</p>`:""}
            </div>
        `,(s=document.getElementById("start-game"))==null||s.classList.add("hidden");return}n.innerHTML=e.map(o=>{if(o.is_valid){const i=o.song_count||0,l=o.spotify_count||i;let u="";return l<i&&(u=`<span class="${l===0?"playlist-coverage playlist-coverage--none":"playlist-coverage playlist-coverage--warning"}">${l}/${i}</span>`),`
                <div class="playlist-item list-item is-selectable">
                    <label class="checkbox-label">
                        <input type="checkbox"
                               class="playlist-checkbox"
                               data-path="${d.escapeHtml(o.path)}"
                               data-song-count="${d.escapeHtml(String(i))}">
                        <span class="playlist-name">${d.escapeHtml(o.name)}</span>
                    </label>
                    <span class="meta">${u||d.escapeHtml(String(i))} songs</span>
                </div>
            `}else{const i=o.errors&&o.errors[0]||"Unknown error";return`
                <div class="list-item is-invalid">
                    <span class="name">${d.escapeHtml(o.name)}</span>
                    <span class="meta">Invalid: ${d.escapeHtml(i)}</span>
                </div>
            `}}).join(""),n.querySelectorAll(".playlist-checkbox").forEach(o=>{o.addEventListener("change",function(){O(this)})}),n.querySelectorAll(".playlist-item.is-selectable").forEach(o=>{o.addEventListener("click",function(i){if(i.target.classList.contains("playlist-checkbox")||i.target.closest(".checkbox-label"))return;const l=o.querySelector(".playlist-checkbox");l&&(l.checked=!l.checked,O(l))})}),a?(c=document.getElementById("start-game"))==null||c.classList.remove("hidden"):(r=document.getElementById("start-game"))==null||r.classList.add("hidden"),U()}function O(e){const t=e.dataset.path,n=parseInt(e.dataset.songCount,10)||0,a=e.closest(".playlist-item");e.checked?(m.some(s=>s.path===t)||m.push({path:t,songCount:n}),a.classList.add("is-selected")):(m=m.filter(s=>s.path!==t),a.classList.remove("is-selected")),U(),C()}function pe(){return m.reduce((e,t)=>e+t.songCount,0)}function U(){const e=document.getElementById("playlist-summary"),t=document.getElementById("selected-count"),n=document.getElementById("total-songs");!e||!t||!n||(m.length===0?e.classList.add("hidden"):(e.classList.remove("hidden"),t.textContent=m.length,n.textContent=pe()))}function C(){const e=document.getElementById("start-game"),t=document.getElementById("playlist-validation-msg"),n=document.getElementById("media-player-validation-msg");if(!e)return;const a=m.length===0,s=y===null;e.disabled=a||s,t&&t.classList.toggle("hidden",!a),n&&n.classList.toggle("hidden",!s)}function V(){var t,n,a;x="setup",p=null,R(),k=[],G.forEach(s=>{const c=document.getElementById(s);c&&c.classList.remove("hidden")}),H.some(s=>s.is_valid)&&((t=document.getElementById("start-game"))==null||t.classList.remove("hidden")),(n=document.getElementById("lobby-section"))==null||n.classList.add("hidden"),(a=document.getElementById("existing-game-section"))==null||a.classList.add("hidden")}function W(e){var c,r,o,i;x="lobby",p=e,G.forEach(l=>{const u=document.getElementById(l);u&&u.classList.add("hidden")}),(c=document.getElementById("start-game"))==null||c.classList.add("hidden"),(r=document.getElementById("playlist-validation-msg"))==null||r.classList.add("hidden"),(o=document.getElementById("existing-game-section"))==null||o.classList.add("hidden"),(i=document.getElementById("lobby-section"))==null||i.classList.remove("hidden");const t=document.getElementById("qr-code");t&&e.join_url&&I!==e.join_url&&(t.innerHTML="",typeof QRCode!="undefined"?new QRCode(t,{text:e.join_url,width:180,height:180,colorDark:"#000000",colorLight:"#ffffff",correctLevel:QRCode.CorrectLevel.M}):t.innerHTML='<p class="status-error">QR code library not loaded</p>',I=e.join_url);const n=document.getElementById("join-url");n&&e.join_url&&(n.textContent=e.join_url);var a=window.location.origin+"/beatify/dashboard",s=document.getElementById("admin-dashboard-url");s&&(s.href=a),z(e.players||[]),ke(),we(e.difficulty||b),ge()}function D(){if(I){var e=document.getElementById("qr-modal"),t=document.getElementById("qr-modal-code");if(!(!e||!t)){t.innerHTML="",typeof QRCode!="undefined"&&new QRCode(t,{text:I,width:280,height:280,colorDark:"#000000",colorLight:"#ffffff",correctLevel:QRCode.CorrectLevel.M}),e.classList.remove("hidden"),document.body.style.overflow="hidden";var n=document.getElementById("qr-modal-close");n&&n.focus()}}}function M(){var e=document.getElementById("qr-modal");e&&(e.classList.add("hidden"),document.body.style.overflow="")}function ge(){var e=document.getElementById("admin-qr-container"),t=document.getElementById("qr-modal"),n=t?t.querySelector(".qr-modal-backdrop"):null,a=document.getElementById("qr-modal-close");e&&(e.addEventListener("click",D),e.addEventListener("keydown",function(s){(s.key==="Enter"||s.key===" ")&&(s.preventDefault(),D())})),n&&n.addEventListener("click",M),a&&a.addEventListener("click",M),document.addEventListener("keydown",function(s){s.key==="Escape"&&t&&!t.classList.contains("hidden")&&M()})}function ye(e){var s,c,r,o,i;x="existing-game",p=e,G.forEach(l=>{const u=document.getElementById(l);u&&u.classList.add("hidden")}),(s=document.getElementById("start-game"))==null||s.classList.add("hidden"),(c=document.getElementById("playlist-validation-msg"))==null||c.classList.add("hidden"),(r=document.getElementById("lobby-section"))==null||r.classList.add("hidden"),(o=document.getElementById("existing-game-section"))==null||o.classList.remove("hidden");const t=document.getElementById("existing-game-id"),n=document.getElementById("existing-game-phase"),a=document.getElementById("existing-game-players");t&&(t.textContent=e.game_id||"Unknown"),n&&(n.textContent=e.phase||"Unknown"),a&&(a.textContent=(i=e.player_count)!=null?i:0)}function ve(){return f(this,null,function*(){const e=document.getElementById("start-game");if(!e||e.disabled)return;e.disabled=!0;const t=e.textContent;e.textContent="Starting...";try{const n=yield fetch("/beatify/api/start-game",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({playlists:m.map(s=>s.path),media_player:y==null?void 0:y.entityId,language:v,round_duration:S,difficulty:b,provider:E,artist_challenge_enabled:w})}),a=yield n.json();if(!n.ok){B(a.message||"Failed to start game");return}a.warnings&&a.warnings.length>0&&console.warn("Game started with warnings:",a.warnings),W(a)}catch(n){B("Network error. Please try again."),console.error("Start game error:",n)}finally{e.disabled=!1,e.textContent=t,C()}})}function he(){const e=document.getElementById("end-game-modal");e&&e.classList.remove("hidden")}function _(){const e=document.getElementById("end-game-modal");e&&e.classList.add("hidden")}function P(){he()}function Ee(){return f(this,null,function*(){_();try{const e=yield fetch("/beatify/api/end-game",{method:"POST"});if(e.ok)I=null,V();else{const t=yield e.json();B(t.message||"Failed to end game")}}catch(e){console.error("End game error:",e),B("Network error. Please try again.")}})}function be(){const e=document.getElementById("end-game-confirm-btn"),t=document.getElementById("end-game-cancel-btn"),n=document.querySelector("#end-game-modal .modal-backdrop");e==null||e.addEventListener("click",Ee),t==null||t.addEventListener("click",_),n==null||n.addEventListener("click",_)}function Le(){return f(this,null,function*(){if(p){try{var e=yield fetch("/beatify/api/status");if(e.ok){var t=yield e.json();t.active_game&&(p=t.active_game)}}catch(n){console.error("Failed to refresh game status:",n)}W(p)}})}function Ie(){window.print()}function B(e){alert(e)}function Be(){var t;const e=document.getElementById("admin-join-modal");e&&(e.classList.remove("hidden"),(t=document.getElementById("admin-name-input"))==null||t.focus())}function $(){const e=document.getElementById("admin-join-modal");e&&e.classList.add("hidden");const t=document.getElementById("admin-name-input"),n=document.getElementById("admin-join-btn"),a=document.getElementById("admin-name-error");t&&(t.value=""),n&&(n.disabled=!0,n.textContent="Join"),a&&a.classList.add("hidden")}function Se(){const e=document.getElementById("participate-btn"),t=document.getElementById("admin-cancel-btn"),n=document.getElementById("admin-join-btn"),a=document.getElementById("admin-name-input"),s=document.querySelector("#admin-join-modal .modal-backdrop");e==null||e.addEventListener("click",Be),t==null||t.addEventListener("click",$),s==null||s.addEventListener("click",$),a==null||a.addEventListener("input",function(){const c=this.value.trim();n.disabled=!c||c.length>20}),a==null||a.addEventListener("keypress",function(c){c.key==="Enter"&&!n.disabled&&J()}),n==null||n.addEventListener("click",J),document.addEventListener("keydown",function(c){if(c.key==="Escape"){const r=document.getElementById("admin-join-modal"),o=document.getElementById("end-game-modal");r&&!r.classList.contains("hidden")&&$(),o&&!o.classList.contains("hidden")&&_()}})}function J(){const e=document.getElementById("admin-name-input"),t=document.getElementById("admin-join-btn"),n=e==null?void 0:e.value.trim();if(n){t.disabled=!0,t.textContent="Joining...";try{sessionStorage.setItem("beatify_admin_name",n),sessionStorage.setItem("beatify_is_admin","true");const a=p==null?void 0:p.game_id;a?window.location.href="/beatify/play?game="+encodeURIComponent(a):(B("No active game found"),t.disabled=!1,t.textContent="Join")}catch(a){console.error("Admin join failed:",a),t.disabled=!1,t.textContent="Join"}}}function we(e){var t=document.getElementById("lobby-difficulty-badge");if(t){var n={easy:"game.difficultyEasy",normal:"game.difficultyNormal",hard:"game.difficultyHard"}[e]||"game.difficultyNormal",a=d.t(n);t.textContent=a,t.className="difficulty-badge difficulty-badge--"+(e||"normal")}}function z(e){var t=document.getElementById("lobby-players"),n=document.getElementById("lobby-player-count"),a=document.getElementById("admin-players-summary"),s=document.getElementById("lobby-players-empty");if(t){if(e=e||[],n&&(n.textContent=e.length),a&&(a.textContent=e.length),e.length===0){t.innerHTML="",s&&s.classList.remove("hidden"),k=[];return}s&&s.classList.add("hidden");var c=e.slice().sort(function(i,l){return i.connected!==l.connected?i.connected?-1:1:0}),r=k.map(function(i){return i.name}),o=c.filter(function(i){return r.indexOf(i.name)===-1}).map(function(i){return i.name});t.innerHTML=c.map(function(i){var l=o.indexOf(i.name)!==-1,u=i.connected===!1,g=i.is_admin===!0,q=["player-card",l?"is-new":"",u?"player-card--disconnected":""].filter(Boolean).join(" "),K=g?'<span class="admin-badge">\u{1F451}</span>':"",X=u?'<span class="away-badge">'+d.t("lobby.away","away")+"</span>":"";return'<div class="'+q+'" data-player="'+d.escapeHtml(i.name)+'"><span class="player-name">'+d.escapeHtml(i.name)+K+"</span>"+X+"</div>"}).join(""),setTimeout(function(){for(var i=t.querySelectorAll(".is-new"),l=0;l<i.length;l++)i[l].classList.remove("is-new")},2e3),k=e.slice()}}function ke(){R(),A=setInterval(function(){return f(this,null,function*(){if(x!=="lobby"){R();return}try{var e=yield fetch("/beatify/api/status");if(!e.ok)return;var t=yield e.json();t.active_game&&t.active_game.players&&z(t.active_game.players)}catch(n){console.error("Lobby polling error:",n)}})},3e3)}function R(){A&&(clearInterval(A),A=null)}"serviceWorker"in navigator&&window.addEventListener("load",function(){navigator.serviceWorker.register("/beatify/static/sw.js",{scope:"/beatify/"}).then(function(e){console.log("[Admin] SW registered:",e.scope)}).catch(function(e){console.warn("[Admin] SW registration failed:",e)})})});Ae();})();
//# sourceMappingURL=admin.min.js.map
